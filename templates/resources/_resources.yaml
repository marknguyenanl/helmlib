{{- define "helmlib.machine" -}}
{{- range $family := $.Values.global.families -}}
{{- if eq $family $.Values.overlay.usefamily -}}
{{- range $machine := $.Values.global.machines -}}
{{- if eq $machine $.Values.overlay.usemachine -}}
resources:
  requests:
    cpu: {{ $family.cpu }}m
    memory: {{ mul $family.memory $machine.memcpu }}Mi
  limits:
    cpu: {{ mul $family.cpu $machine.limitrequest }}m
    memory: {{ mul $family.memory $machine.memcpu $machine.limitrequest }}Mi
{{- end -}}
{{- end -}}
{{- end -}}
{{- end -}}
{{- end -}}
