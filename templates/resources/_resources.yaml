{{- define "helmlib.engine.requests" -}}
{{- $usedengine := .Values.overlay.usedengine -}}
{{- $engineRequests := .Values.root.engineRequests }}
requests:
  cpu: {{ pluck $usedengine $engineRequests | first | default $engineRequests.cpu._default }}
  memory: {{ pluck $usedengine $engineRequests | first | default $engineRequests.memory._default }}
{{- end -}}

{{- define "helmlib.engine.limits" -}}
{{- $usedengine := .Values.overlay.usedengine -}}
{{- $engineLimits := .Values.root.engineLimits }}
limits:
  cpu: {{ pluck $usedengine $engineLimits | first | default $engineLimits.cpu._default }}
  memory: {{ pluck $usedengine $engineLimits | first | default $engineLimits.memory._default }}
{{- end -}}

{{- define "helmlib.engine.resources" -}}
resources:
{{- include "helmlib.engine.requests" . | nindent 2 -}}
{{- include "helmlib.engine.limits" . | nindent 2 -}}
{{- end -}}

